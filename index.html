const video = document.getElementById("video");
const startBtn = document.getElementById("startCam");

let camera = null;

const hands = new Hands({
  locateFile: f => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${f}`
});

hands.setOptions({
  maxNumHands: 1,
  minDetectionConfidence: 0.75,
  minTrackingConfidence: 0.75
});

hands.onResults(results => {
  if (!results.multiHandLandmarks) return;
  // gesture logic tetap sama
});

startBtn.addEventListener("click", async () => {
  startBtn.style.display = "none";

  try {
    // REQUEST CAMERA PERMISSION (WAJIB DI IOS)
    await navigator.mediaDevices.getUserMedia({ video: true });

    camera = new Camera(video, {
      onFrame: async () => {
        await hands.send({ image: video });
      },
      width: 640,
      height: 480
    });

    await camera.start();

  } catch (err) {
    alert("Kamera tidak bisa diakses. Pastikan izin kamera diaktifkan.");
    console.error(err);
  }
});
