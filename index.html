<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Cosmic Touch</title>

<style>
html,body{
  margin:0;
  padding:0;
  background:black;
  overflow:hidden;
  font-family: system-ui, sans-serif;
}
canvas{
  position:fixed;
  top:0;left:0;
}
#halo{
  position:fixed;
  bottom:18%;
  left:50%;
  transform:translateX(-50%);
  width:20px;height:20px;
  border-radius:50%;
  background:#4ff;
  opacity:0;
  box-shadow:0 0 20px #4ff;
  transition:.2s;
}
#text{
  position:fixed;
  top:45%;
  width:100%;
  text-align:center;
  font-size:clamp(28px,7vw,60px);
  color:white;
  letter-spacing:3px;
  opacity:0;
}
video{
  position:fixed;
  bottom:12px;
  right:12px;
  width:110px;
  border-radius:12px;
  opacity:.9;
}
</style>
</head>

<body>
<canvas id="stars"></canvas>
<div id="halo"></div>
<div id="text">KAMU HADIR</div>
<video id="cam" autoplay playsinline></video>

<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

<script>
const canvas=document.getElementById("stars");
const ctx=canvas.getContext("2d");
const halo=document.getElementById("halo");
const text=document.getElementById("text");
canvas.width=innerWidth;
canvas.height=innerHeight;

const stars=[...Array(300)].map(()=>({
 x:Math.random()*canvas.width,
 y:Math.random()*canvas.height,
 r:Math.random()*1.5+0.5,
 vx:(Math.random()-.5)*0.2,
 vy:(Math.random()-.5)*0.2,
 c:`hsl(${200+Math.random()*120},100%,70%)`
}));

let triggered=false;
function animate(){
 ctx.clearRect(0,0,canvas.width,canvas.height);
 stars.forEach(s=>{
  s.x+=s.vx; s.y+=s.vy;
  if(s.x<0)s.x=canvas.width;
  if(s.y<0)s.y=canvas.height;
  ctx.fillStyle=s.c;
  ctx.beginPath();
  ctx.arc(s.x,s.y,s.r,0,Math.PI*2);
  ctx.fill();
 });
 requestAnimationFrame(animate);
}
animate();

// === HAND TRACKING ===
const video=document.getElementById("cam");
let stableFrames=0;

const hands=new Hands({
 locateFile:f=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${f}`
});
hands.setOptions({
 maxNumHands:1,
 modelComplexity:0,
 minDetectionConfidence:0.6,
 minTrackingConfidence:0.6
});

hands.onResults(res=>{
 if(!res.multiHandLandmarks) {
   stableFrames=0;
   halo.style.opacity=0;
   return;
 }

 const lm=res.multiHandLandmarks[0];
 const fingers=[
  lm[8].y<lm[6].y,
  lm[12].y<lm[10].y,
  lm[16].y<lm[14].y,
  lm[20].y<lm[18].y
 ];
 const thumb=lm[4].x<lm[3].x;
 const openHand=fingers.every(f=>f)&&thumb;

 if(openHand){
   stableFrames++;
   halo.style.opacity=1;
   if(stableFrames>12 && !triggered){
     triggered=true;
     text.style.opacity=1;
     stars.forEach(s=>{
       s.vx=(canvas.width/2-s.x)/120;
       s.vy=(canvas.height/2-s.y)/120;
     });
   }
 }else{
   stableFrames=0;
   halo.style.opacity=0;
 }
});

const camera=new Camera(video,{
 onFrame:async()=>{await hands.send({image:video});},
 width:640,height:480
});
camera.start();
</script>
</body>
</html>
