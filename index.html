<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta name="screen-orientation" content="portrait">
<meta name="orientation" content="portrait">
<title>Dear Laily</title>

<style>
html,body{
  margin:0;
  padding:0;
  background:#000;
  overflow:hidden;
  touch-action:none;
  font-family:Georgia,serif;
}
canvas{position:fixed;inset:0}
#cameraBox{
  position:fixed;
  bottom:12px;right:12px;
  width:110px;aspect-ratio:3/4;
  border-radius:12px;
  overflow:hidden;
  border:1px solid rgba(255,255,255,.35);
  z-index:10;background:#000
}
#cameraBox video{
  width:100%;height:100%;
  object-fit:cover;
  transform:scaleX(-1)
  transform:scaleX(-1);
}
#hint{
  position:fixed;
@@ -54,10 +54,7 @@
/* ================= CANVAS ================= */
const canvas=c;
const ctx=canvas.getContext("2d");
function resize(){
  canvas.width=innerWidth;
  canvas.height=innerHeight;
}
function resize(){canvas.width=innerWidth;canvas.height=innerHeight;}
resize();addEventListener("resize",resize);

/* ================= STATE ================= */
@@ -121,12 +118,25 @@

/* ================= TARGETS ================= */
const TARGETS={
  one:makeText(`Dear Laily Aliyah,\n\nI want to sincerely apologize\nfor the situation that happened.`),
  two:makeText(`I never intended to deceive you.\nI respect your feelings.`),
  three:makeText(`I’m really sorry\nfor the misunderstanding.`),
  four:makeHeart(),
  five:makeText(`ilysm ly ♥`),
  fist:makeText(`from: Raja Iblis`)
  fist: makeText(`from: Raja Iblis`),

  one: makeText(
`Dear Laily Aliyah,

I want to sincerely apologize
for the situation that happened.`),

  two: makeText(
`I respect your feelings
and I never intended to deceive you.`),

  three: makeText(
`I’m really sorry
for the misunderstanding.`),

  four: makeHeart(),

  five: makeText(`ilysm ly ♥`)
};

/* ================= ANIMATE ================= */
@@ -164,7 +174,6 @@
  hands=new Hands({
    locateFile:f=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${f}`
  });

  hands.setOptions({
    maxNumHands:1,
    modelComplexity:1,
@@ -180,19 +189,22 @@

    lastHandTime=Date.now();
    const lm=res.multiHandLandmarks[0];

    let fingers=0;
    const tips=[8,12,16,20];
    tips.forEach(t=>{
      if(lm[t].y<lm[t-2].y) fingers++;
    });
    if(lm[4].x<lm[3].x) fingers++;

    fingers=Math.max(0,Math.min(5,fingers)); // CLAMP

    if(fingers===0) currentState="fist";
    else if(fingers===1) currentState="one";
    else if(fingers===2) currentState="two";
    else if(fingers===3) currentState="three";
    else if(fingers===4) currentState="four";
    else currentState="five";
    else if(fingers===5) currentState="five";
  });
}

@@ -215,17 +227,15 @@
  },400);
}

/* WATCHDOG — INI KUNCINYA */
setInterval(()=>{
  if(Date.now()-lastHandTime>1200){
    restartPipeline();
    lastHandTime=Date.now();
  }
},500);

/* START */
initHands();
startCamera();
</script>
</body>
</html>
